<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Privacy Settings - SocialConnect</title>
    <link rel="stylesheet" href="../css/generic.css">
    <link rel="stylesheet" href="../css/privacy-settings.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="main-feed.html">SocialConnect</a>
            </div>
            
            <div class="nav-search">
                <input type="text" placeholder="Search..." id="globalSearch">
                <button type="button" class="search-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </button>
            </div>

            <div class="nav-menu" id="navMenu">
                <div class="nav-links">
                    <a href="main-feed.html" class="nav-link">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        </svg>
                        Home
                    </a>
                    <a href="messages.html" class="nav-link">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        </svg>
                        Messages
                    </a>
                    <a href="notifications.html" class="nav-link">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"></path>
                            <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"></path>
                        </svg>
                        Notifications
                    </a>
                </div>

                <div class="nav-profile">
                    <div class="dropdown">
                        <button class="dropdown-toggle profile-btn">
                            <img src="../images/avatar-placeholder.svg" alt="Profile" class="profile-avatar">
                            <span>John Doe</span>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6,9 12,15 18,9"></polyline>
                            </svg>
                        </button>
                        <div class="dropdown-menu">
                            <a href="user-profile.html" class="dropdown-item">View Profile</a>
                            <a href="edit-profile.html" class="dropdown-item">Edit Profile</a>
                            <a href="manage-account.html" class="dropdown-item">Account Settings</a>
                            <a href="privacy-settings.html" class="dropdown-item active">Privacy Settings</a>
                            <div class="dropdown-divider"></div>
                            <a href="help-support.html" class="dropdown-item">Help & Support</a>
                            <a href="login.html" class="dropdown-item text-danger">Sign Out</a>
                        </div>
                    </div>
                </div>
            </div>

            <button class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="settings-container">
            <!-- Settings Navigation -->
            <div class="settings-sidebar">
                <h2>Settings</h2>
                <nav class="settings-nav">
                    <a href="manage-account.html" class="settings-nav-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                        Account Settings
                    </a>
                    <a href="edit-profile.html" class="settings-nav-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit Profile
                    </a>
                    <a href="privacy-settings.html" class="settings-nav-item active">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                            <circle cx="12" cy="16" r="1"></circle>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                        </svg>
                        Privacy Settings
                    </a>
                    <a href="notifications.html" class="settings-nav-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"></path>
                            <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"></path>
                        </svg>
                        Notifications
                    </a>
                    <a href="saved-content.html" class="settings-nav-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
                        </svg>
                        Saved Content
                    </a>
                    <a href="help-support.html" class="settings-nav-item">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                        Help & Support
                    </a>
                </nav>
            </div>

            <!-- Privacy Settings Content -->
            <div class="settings-content">
                <div class="settings-header">
                    <h1>Privacy Settings</h1>
                    <p>Manage who can see your content and how you interact with others on SocialConnect.</p>
                </div>

                <form id="privacyForm" class="settings-form">
                    <!-- Profile Privacy -->
                    <div class="settings-section">
                        <div class="section-header">
                            <h2>Profile Privacy</h2>
                            <p>Control who can see your profile information</p>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Profile Visibility</h3>
                                <p>Who can see your profile</p>
                            </div>
                            <div class="setting-control">
                                <select name="profileVisibility" class="form-select">
                                    <option value="public">Everyone</option>
                                    <option value="friends" selected>Friends Only</option>
                                    <option value="private">Only Me</option>
                                </select>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Search Visibility</h3>
                                <p>Allow others to find you in search results</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" name="searchVisibility" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Contact Information</h3>
                                <p>Who can see your email and phone number</p>
                            </div>
                            <div class="setting-control">
                                <select name="contactVisibility" class="form-select">
                                    <option value="public">Everyone</option>
                                    <option value="friends" selected>Friends Only</option>
                                    <option value="private">Only Me</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Posts & Content -->
                    <div class="settings-section">
                        <div class="section-header">
                            <h2>Posts & Content</h2>
                            <p>Manage who can see and interact with your posts</p>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Default Post Privacy</h3>
                                <p>Who can see your future posts by default</p>
                            </div>
                            <div class="setting-control">
                                <select name="defaultPostPrivacy" class="form-select">
                                    <option value="public">Public</option>
                                    <option value="friends" selected>Friends</option>
                                    <option value="close-friends">Close Friends</option>
                                    <option value="private">Only Me</option>
                                </select>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Comments</h3>
                                <p>Who can comment on your posts</p>
                            </div>
                            <div class="setting-control">
                                <select name="commentPrivacy" class="form-select">
                                    <option value="everyone">Everyone</option>
                                    <option value="friends" selected>Friends Only</option>
                                    <option value="disabled">No One</option>
                                </select>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Tags and Mentions</h3>
                                <p>Approve tags before they appear on your profile</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" name="tagApproval" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Share Posts</h3>
                                <p>Allow others to share your posts</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" name="shareEnabled" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Messages & Communication -->
                    <div class="settings-section">
                        <div class="section-header">
                            <h2>Messages & Communication</h2>
                            <p>Control who can contact you and how</p>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Message Requests</h3>
                                <p>Who can send you direct messages</p>
                            </div>
                            <div class="setting-control">
                                <select name="messagePrivacy" class="form-select">
                                    <option value="everyone">Everyone</option>
                                    <option value="friends" selected>Friends Only</option>
                                    <option value="disabled">No One</option>
                                </select>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Read Receipts</h3>
                                <p>Let others know when you've read their messages</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" name="readReceipts" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Online Status</h3>
                                <p>Show when you're active or recently active</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" name="onlineStatus" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Typing Indicators</h3>
                                <p>Show when you're typing a message</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" name="typingIndicators" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Activity & Location -->
                    <div class="settings-section">
                        <div class="section-header">
                            <h2>Activity & Location</h2>
                            <p>Manage what activity information is shared</p>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Activity Status</h3>
                                <p>Show your friends when you're active</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" name="activityStatus" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Location Services</h3>
                                <p>Allow location-based features and posts</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" name="locationServices">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Login Activity</h3>
                                <p>Track and display login locations and devices</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" name="loginActivity" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Data & Downloads -->
                    <div class="settings-section">
                        <div class="section-header">
                            <h2>Data & Downloads</h2>
                            <p>Manage your data and download options</p>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Data Portability</h3>
                                <p>Download a copy of your data</p>
                            </div>
                            <div class="setting-control">
                                <button type="button" class="btn btn-secondary" id="downloadDataBtn">
                                    Request Data Download
                                </button>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Search History</h3>
                                <p>Save your search history for better recommendations</p>
                            </div>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" name="searchHistory" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Clear Activity Data</h3>
                                <p>Remove stored activity and interaction data</p>
                            </div>
                            <div class="setting-control">
                                <button type="button" class="btn btn-danger" id="clearDataBtn">
                                    Clear Activity Data
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Blocked Users -->
                    <div class="settings-section">
                        <div class="section-header">
                            <h2>Blocked Users</h2>
                            <p>Manage users you've blocked</p>
                        </div>

                        <div class="blocked-users-list" id="blockedUsersList">
                            <div class="blocked-user-item">
                                <div class="blocked-user-info">
                                    <img src="../images/avatar-placeholder.svg" alt="Blocked user" class="blocked-user-avatar">
                                    <div class="blocked-user-details">
                                        <h4>Mike Thompson</h4>
                                        <p>Blocked on March 15, 2024</p>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-secondary unblock-btn" data-user="mike-thompson">
                                    Unblock
                                </button>
                            </div>

                            <div class="blocked-user-item">
                                <div class="blocked-user-info">
                                    <img src="../images/avatar-placeholder.svg" alt="Blocked user" class="blocked-user-avatar">
                                    <div class="blocked-user-details">
                                        <h4>spam_account_123</h4>
                                        <p>Blocked on February 28, 2024</p>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-secondary unblock-btn" data-user="spam-account">
                                    Unblock
                                </button>
                            </div>

                            <div class="empty-state" id="emptyBlockedList" style="display: none;">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <path d="M4.93 4.93l14.14 14.14"></path>
                                </svg>
                                <h3>No blocked users</h3>
                                <p>You haven't blocked anyone yet.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Account Deletion -->
                    <div class="settings-section danger-section">
                        <div class="section-header">
                            <h2>Account Deletion</h2>
                            <p>Permanently delete your SocialConnect account</p>
                        </div>

                        <div class="setting-item">
                            <div class="setting-info">
                                <h3>Delete Account</h3>
                                <p>This action cannot be undone. All your data will be permanently deleted.</p>
                            </div>
                            <div class="setting-control">
                                <button type="button" class="btn btn-danger" id="deleteAccountBtn">
                                    Delete Account
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="resetForm">Reset Changes</button>
                        <button type="submit" class="btn btn-primary">Save Settings</button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <!-- Confirmation Modals -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="confirmTitle">Confirm Action</h3>
                <button class="modal-close" id="closeConfirmModal">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Are you sure you want to proceed?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelConfirm">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmAction">Confirm</button>
            </div>
        </div>
    </div>

    <script>
        // Navigation functionality
        document.getElementById('navToggle').addEventListener('click', function() {
            const navMenu = document.getElementById('navMenu');
            navMenu.classList.toggle('active');
        });

        // Dropdown functionality
        document.querySelectorAll('.dropdown-toggle').forEach(toggle => {
            toggle.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                const dropdown = this.parentElement;
                dropdown.classList.toggle('active');
            });
        });

        // Close dropdowns when clicking outside
        document.addEventListener('click', function() {
            document.querySelectorAll('.dropdown').forEach(dropdown => {
                dropdown.classList.remove('active');
            });
        });

        // Form handling
        document.getElementById('privacyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            savePrivacySettings();
        });

        function savePrivacySettings() {
            // Collect form data
            const formData = new FormData(document.getElementById('privacyForm'));
            const settings = {};
            
            // Convert FormData to object
            for (let [key, value] of formData.entries()) {
                settings[key] = value;
            }
            
            // Handle checkboxes (they won't be in FormData if unchecked)
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                settings[checkbox.name] = checkbox.checked;
            });
            
            console.log('Saving privacy settings:', settings);
            
            // Simulate API call
            showAlert('Privacy settings saved successfully!', 'success');
        }

        // Reset form
        document.getElementById('resetForm').addEventListener('click', function() {
            if (confirm('Are you sure you want to reset all changes?')) {
                document.getElementById('privacyForm').reset();
                showAlert('Settings reset to last saved state.', 'info');
            }
        });

        // Download data
        document.getElementById('downloadDataBtn').addEventListener('click', function() {
            showConfirmModal(
                'Request Data Download',
                'We will prepare your data for download and send you an email when it\'s ready. This may take up to 24 hours.',
                () => {
                    showAlert('Data download request submitted. You will receive an email when your data is ready.', 'success');
                }
            );
        });

        // Clear activity data
        document.getElementById('clearDataBtn').addEventListener('click', function() {
            showConfirmModal(
                'Clear Activity Data',
                'This will permanently delete your search history, interaction data, and activity logs. This action cannot be undone.',
                () => {
                    showAlert('Activity data cleared successfully.', 'success');
                }
            );
        });

        // Unblock users
        document.querySelectorAll('.unblock-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const userName = this.dataset.user;
                showConfirmModal(
                    'Unblock User',
                    'Are you sure you want to unblock this user? They will be able to contact you and see your content again.',
                    () => {
                        this.closest('.blocked-user-item').remove();
                        showAlert('User unblocked successfully.', 'success');
                        
                        // Check if list is empty
                        const remainingItems = document.querySelectorAll('.blocked-user-item');
                        if (remainingItems.length === 0) {
                            document.getElementById('emptyBlockedList').style.display = 'block';
                        }
                    }
                );
            });
        });

        // Delete account
        document.getElementById('deleteAccountBtn').addEventListener('click', function() {
            showConfirmModal(
                'Delete Account',
                'Are you absolutely sure you want to delete your account? This action cannot be undone and all your data will be permanently lost.',
                () => {
                    // This would typically redirect to a more detailed deletion flow
                    alert('Account deletion initiated. You will be redirected to complete the process.');
                    // window.location.href = 'delete-account.html';
                }
            );
        });

        // Confirmation modal
        function showConfirmModal(title, message, onConfirm) {
            const modal = document.getElementById('confirmModal');
            const titleEl = document.getElementById('confirmTitle');
            const messageEl = document.getElementById('confirmMessage');
            const confirmBtn = document.getElementById('confirmAction');
            
            titleEl.textContent = title;
            messageEl.textContent = message;
            
            // Remove existing event listeners
            const newConfirmBtn = confirmBtn.cloneNode(true);
            confirmBtn.parentNode.replaceChild(newConfirmBtn, confirmBtn);
            
            // Add new event listener
            newConfirmBtn.addEventListener('click', function() {
                onConfirm();
                modal.classList.remove('active');
            });
            
            modal.classList.add('active');
        }

        // Modal controls
        document.getElementById('closeConfirmModal').addEventListener('click', function() {
            document.getElementById('confirmModal').classList.remove('active');
        });

        document.getElementById('cancelConfirm').addEventListener('click', function() {
            document.getElementById('confirmModal').classList.remove('active');
        });

        document.getElementById('confirmModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.remove('active');
            }
        });

        // Alert system
        function showAlert(message, type = 'info') {
            // Create alert element
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.innerHTML = `
                <span>${message}</span>
                <button class="alert-close">&times;</button>
            `;
            
            // Add to page
            document.body.appendChild(alert);
            
            // Position alert
            alert.style.position = 'fixed';
            alert.style.top = '20px';
            alert.style.right = '20px';
            alert.style.zIndex = '9999';
            alert.style.maxWidth = '400px';
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (alert.parentNode) {
                    alert.remove();
                }
            }, 5000);
            
            // Manual close
            alert.querySelector('.alert-close').addEventListener('click', function() {
                alert.remove();
            });
        }

        // Settings change tracking
        let initialFormData = new FormData(document.getElementById('privacyForm'));
        
        function hasUnsavedChanges() {
            const currentFormData = new FormData(document.getElementById('privacyForm'));
            // Compare form data (simplified check)
            return true; // Would implement proper comparison in real app
        }

        // Warn about unsaved changes
        window.addEventListener('beforeunload', function(e) {
            if (hasUnsavedChanges()) {
                e.preventDefault();
                e.returnValue = '';
            }
        });

        // Toggle switches enhancement
        document.querySelectorAll('.toggle-switch input').forEach(toggle => {
            toggle.addEventListener('change', function() {
                // Add visual feedback or trigger specific actions based on the setting
                console.log(`${this.name} toggled to: ${this.checked}`);
            });
        });
    </script>
</body>
</html>
