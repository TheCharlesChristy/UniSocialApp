<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Your Password - SocialConnect</title>
    <meta name="description" content="Reset your SocialConnect password securely. Enter your email to receive password reset instructions.">
    <link rel="stylesheet" href="../css/generic.css">
    <link rel="stylesheet" href="../css/forgot_password.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header">
        <nav class="navbar container">
            <a href="welcome.html" class="logo">SocialConnect</a>
            <ul class="nav-menu">
                <li><a href="welcome.html" class="nav-link active">Home</a></li>
                <li><a href="login.html" class="nav-link">Sign In</a></li>
                <li><a href="register.html" class="btn btn-primary">Register</a></li>
            </ul>
            <button class="nav-toggle" aria-label="Toggle navigation">‚ò∞</button>
        </nav>
    </header>

    <main class="auth-main">
        <div class="container">
            <div class="forgot-password-container">
                <!-- Back Button -->
                <div class="back-navigation">
                    <a href="login.html" class="back-btn">
                        <span class="back-icon">‚Üê</span>
                        Back to Sign In
                    </a>
                </div>

                <!-- Main Content -->
                <div class="forgot-password-content">
                    <!-- Step 1: Request Reset -->
                    <div class="reset-step active" id="step-request">
                        <div class="reset-header">
                            <div class="reset-icon">üîí</div>
                            <h1>Forgot your password?</h1>
                            <p>No worries! Enter your email address and we'll send you a link to reset your password.</p>
                        </div>

                        <form class="reset-form" id="resetRequestForm" novalidate>
                            <div class="form-group">
                                <label for="email" class="form-label">Email address</label>
                                <input 
                                    type="email" 
                                    id="email" 
                                    name="email" 
                                    class="form-input" 
                                    placeholder="Enter your email address"
                                    required
                                    aria-describedby="email-error"
                                >
                                <div class="form-error" id="email-error" role="alert"></div>
                            </div>

                            <button type="submit" class="btn btn-primary btn-full btn-lg">
                                <span class="btn-text">Send Reset Link</span>
                                <span class="spinner hidden"></span>
                            </button>

                            <div class="reset-footer">
                                <p>Remember your password? <a href="login.html">Sign in instead</a></p>
                            </div>
                        </form>
                    </div>

                    <!-- Step 2: Email Sent Confirmation -->
                    <div class="reset-step" id="step-sent">
                        <div class="reset-header">
                            <div class="reset-icon success">üìß</div>
                            <h1>Check your email</h1>
                            <p>We've sent a password reset link to <strong id="sent-email"></strong></p>
                        </div>

                        <div class="reset-instructions">
                            <h3>What's next?</h3>
                            <ol class="instruction-list">
                                <li>Check your email inbox (and spam folder)</li>
                                <li>Click the "Reset Password" link in the email</li>
                                <li>Create your new password</li>
                                <li>Sign in with your new password</li>
                            </ol>
                        </div>

                        <div class="reset-actions">
                            <button type="button" class="btn btn-outline btn-full" id="resendBtn">
                                <span class="btn-text">Resend Email</span>
                                <span class="spinner hidden"></span>
                            </button>
                            
                            <div class="reset-footer">
                                <p>Didn't receive the email? Check your spam folder or <a href="#" id="changeEmailBtn">use a different email address</a></p>
                            </div>
                        </div>

                        <!-- Resend Timer -->
                        <div class="resend-timer" id="resendTimer">
                            <p>You can request another email in <span id="countdown">60</span> seconds</p>
                        </div>
                    </div>

                    <!-- Step 3: Reset Password Form (when accessed via email link) -->
                    <div class="reset-step" id="step-reset">
                        <div class="reset-header">
                            <div class="reset-icon">üîë</div>
                            <h1>Create new password</h1>
                            <p>Your new password must be different from your previous password.</p>
                        </div>

                        <form class="reset-form" id="newPasswordForm" novalidate>
                            <div class="form-group">
                                <label for="newPassword" class="form-label">New password</label>
                                <div class="password-input-wrapper">
                                    <input 
                                        type="password" 
                                        id="newPassword" 
                                        name="newPassword" 
                                        class="form-input" 
                                        placeholder="Enter your new password"
                                        required
                                        minlength="8"
                                        aria-describedby="newPassword-error newPassword-help"
                                    >
                                    <button type="button" class="password-toggle" aria-label="Toggle password visibility">
                                        üëÅÔ∏è
                                    </button>
                                </div>
                                <div class="form-help" id="newPassword-help">At least 8 characters with a mix of letters, numbers, and symbols</div>
                                <div class="form-error" id="newPassword-error" role="alert"></div>
                                
                                <!-- Password Strength Indicator -->
                                <div class="password-strength" id="password-strength">
                                    <div class="strength-bar">
                                        <div class="strength-fill"></div>
                                    </div>
                                    <span class="strength-text">Password strength</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="confirmNewPassword" class="form-label">Confirm new password</label>
                                <div class="password-input-wrapper">
                                    <input 
                                        type="password" 
                                        id="confirmNewPassword" 
                                        name="confirmNewPassword" 
                                        class="form-input" 
                                        placeholder="Confirm your new password"
                                        required
                                        aria-describedby="confirmNewPassword-error"
                                    >
                                    <button type="button" class="password-toggle" aria-label="Toggle password visibility">
                                        üëÅÔ∏è
                                    </button>
                                </div>
                                <div class="form-error" id="confirmNewPassword-error" role="alert"></div>
                            </div>

                            <button type="submit" class="btn btn-primary btn-full btn-lg">
                                <span class="btn-text">Update Password</span>
                                <span class="spinner hidden"></span>
                            </button>
                        </form>
                    </div>

                    <!-- Step 4: Success -->
                    <div class="reset-step" id="step-success">
                        <div class="reset-header">
                            <div class="reset-icon success">‚úÖ</div>
                            <h1>Password updated successfully!</h1>
                            <p>Your password has been updated. You can now sign in with your new password.</p>
                        </div>

                        <div class="reset-actions">
                            <a href="login.html" class="btn btn-primary btn-full btn-lg">
                                Continue to Sign In
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Security Notice -->
                <div class="security-notice">
                    <div class="notice-icon">üõ°Ô∏è</div>
                    <div class="notice-content">
                        <h4>Security Notice</h4>
                        <p>For your security, password reset links expire after 24 hours. If you didn't request this reset, please contact our support team.</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>

        // Password strength checker
        function checkPasswordStrength(password) {
            let strength = 0;
            const checks = {
                length: password.length >= 8,
                lowercase: /[a-z]/.test(password),
                uppercase: /[A-Z]/.test(password),
                numbers: /\d/.test(password),
                symbols: /[^A-Za-z0-9]/.test(password)
            };

            strength = Object.values(checks).filter(Boolean).length;

            if (strength < 2) return 'weak';
            if (strength < 3) return 'fair';
            if (strength < 4) return 'good';
            return 'strong';
        }

        // Password strength indicator
        const newPasswordInput = document.getElementById('newPassword');
        if (newPasswordInput) {
            newPasswordInput.addEventListener('input', function() {
                const password = this.value;
                const strengthFill = document.querySelector('.strength-fill');
                const strengthText = document.querySelector('.strength-text');
                
                if (password.length === 0) {
                    strengthFill.className = 'strength-fill';
                    strengthText.textContent = 'Password strength';
                    return;
                }

                const strength = checkPasswordStrength(password);
                strengthFill.className = `strength-fill ${strength}`;
                strengthText.textContent = `Password strength: ${strength.charAt(0).toUpperCase() + strength.slice(1)}`;
            });
        }

        // Password confirmation validation
        const confirmPasswordInput = document.getElementById('confirmNewPassword');
        if (confirmPasswordInput) {
            confirmPasswordInput.addEventListener('input', function() {
                const password = document.getElementById('newPassword').value;
                const confirmPassword = this.value;
                const errorElement = document.getElementById('confirmNewPassword-error');

                if (confirmPassword && password !== confirmPassword) {
                    errorElement.textContent = 'Passwords do not match.';
                    this.classList.add('invalid');
                    this.classList.remove('valid');
                } else if (confirmPassword) {
                    errorElement.textContent = '';
                    this.classList.add('valid');
                    this.classList.remove('invalid');
                }
            });
        }

        // Password toggle functionality
        document.querySelectorAll('.password-toggle').forEach(toggle => {
            toggle.addEventListener('click', function() {
                const passwordInput = this.parentElement.querySelector('input');
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type);
                this.textContent = type === 'password' ? 'üëÅÔ∏è' : 'üôà';
            });
        });

        // Mobile navigation toggle
        document.querySelector('.nav-toggle').addEventListener('click', function() {
            document.querySelector('.nav-menu').classList.toggle('active');
        });
    </script>
</body>
</html>
