<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversation with Sarah Wilson - SocialConnect</title>
    <link rel="stylesheet" href="../css/generic.css">
    <link rel="stylesheet" href="../css/conversation.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="main-feed.html">SocialConnect</a>
            </div>
            
            <div class="nav-search">
                <input type="text" placeholder="Search..." id="globalSearch">
                <button type="button" class="search-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </button>
            </div>

            <div class="nav-menu" id="navMenu">
                <div class="nav-links">
                    <a href="main-feed.html" class="nav-link">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        </svg>
                        Home
                    </a>
                    <a href="messages.html" class="nav-link active">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        </svg>
                        Messages
                    </a>
                    <a href="notifications.html" class="nav-link">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"></path>
                            <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"></path>
                        </svg>
                        Notifications
                    </a>
                </div>

                <div class="nav-profile">
                    <div class="dropdown">
                        <button class="dropdown-toggle profile-btn">
                            <img src="../images/avatar-placeholder.svg" alt="Profile" class="profile-avatar">
                            <span>John Doe</span>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6,9 12,15 18,9"></polyline>
                            </svg>
                        </button>
                        <div class="dropdown-menu">
                            <a href="user-profile.html" class="dropdown-item">View Profile</a>
                            <a href="edit-profile.html" class="dropdown-item">Edit Profile</a>
                            <a href="manage-account.html" class="dropdown-item">Account Settings</a>
                            <a href="privacy-settings.html" class="dropdown-item">Privacy Settings</a>
                            <div class="dropdown-divider"></div>
                            <a href="help-support.html" class="dropdown-item">Help & Support</a>
                            <a href="login.html" class="dropdown-item text-danger">Sign Out</a>
                        </div>
                    </div>
                </div>
            </div>

            <button class="nav-toggle" id="navToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="conversation-container">
            <!-- Conversation Header -->
            <div class="conversation-header">
                <div class="conversation-back">
                    <a href="messages.html" class="back-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="15,18 9,12 15,6"></polyline>
                        </svg>
                        Messages
                    </a>
                </div>
                <div class="conversation-info">
                    <div class="conversation-avatar">
                        <img src="../images/avatar-placeholder.svg" alt="Sarah Wilson">
                        <span class="status-indicator online"></span>
                    </div>
                    <div class="conversation-details">
                        <h2>Sarah Wilson</h2>
                        <p class="status-text">Active now</p>
                    </div>
                </div>
                <div class="conversation-actions">
                    <button class="action-btn" id="videoCallBtn" title="Video Call">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="23 7 16 12 23 17 23 7"></polygon>
                            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
                        </svg>
                    </button>
                    <button class="action-btn" id="audioCallBtn" title="Audio Call">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                        </svg>
                    </button>
                    <div class="dropdown">
                        <button class="action-btn dropdown-toggle" title="More Options">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="1"></circle>
                                <circle cx="12" cy="5" r="1"></circle>
                                <circle cx="12" cy="19" r="1"></circle>
                            </svg>
                        </button>
                        <div class="dropdown-menu dropdown-menu-right">
                            <button class="dropdown-item" id="viewProfileBtn">View Profile</button>
                            <button class="dropdown-item" id="muteConversationBtn">Mute Conversation</button>
                            <button class="dropdown-item" id="archiveConversationBtn">Archive</button>
                            <div class="dropdown-divider"></div>
                            <button class="dropdown-item text-danger" id="blockUserBtn">Block User</button>
                            <button class="dropdown-item text-danger" id="deleteConversationBtn">Delete Conversation</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Messages Area -->
            <div class="messages-area" id="messagesArea">
                <div class="messages-list">
                    <!-- Date Separator -->
                    <div class="date-separator">
                        <span>Today</span>
                    </div>

                    <!-- Received Message -->
                    <div class="message received">
                        <div class="message-avatar">
                            <img src="../images/avatar-placeholder.svg" alt="Sarah Wilson">
                        </div>
                        <div class="message-content">
                            <div class="message-bubble">
                                <p>Hey John! How's the new project coming along?</p>
                            </div>
                            <div class="message-meta">
                                <span class="message-time">10:30 AM</span>
                            </div>
                        </div>
                    </div>

                    <!-- Sent Message -->
                    <div class="message sent">
                        <div class="message-content">
                            <div class="message-bubble">
                                <p>It's going really well! We just finished the initial wireframes and the client loves them.</p>
                            </div>
                            <div class="message-meta">
                                <span class="message-time">10:32 AM</span>
                                <span class="message-status read">✓✓</span>
                            </div>
                        </div>
                    </div>

                    <!-- Received Message with Image -->
                    <div class="message received">
                        <div class="message-avatar">
                            <img src="../images/avatar-placeholder.svg" alt="Sarah Wilson">
                        </div>
                        <div class="message-content">
                            <div class="message-bubble">
                                <p>That's awesome! I'd love to see them when you get a chance.</p>
                                <div class="message-image">
                                    <img src="../images/sample-design.jpg" alt="Design sample" onclick="openImageModal(this.src)">
                                </div>
                                <p>I found this inspiration that might be helpful for your project!</p>
                            </div>
                            <div class="message-meta">
                                <span class="message-time">10:35 AM</span>
                            </div>
                        </div>
                    </div>

                    <!-- Sent Message -->
                    <div class="message sent">
                        <div class="message-content">
                            <div class="message-bubble">
                                <p>Wow, that's beautiful! The color scheme would work perfectly with our brand guidelines.</p>
                            </div>
                            <div class="message-meta">
                                <span class="message-time">10:38 AM</span>
                                <span class="message-status read">✓✓</span>
                            </div>
                        </div>
                    </div>

                    <!-- Received Message -->
                    <div class="message received">
                        <div class="message-avatar">
                            <img src="../images/avatar-placeholder.svg" alt="Sarah Wilson">
                        </div>
                        <div class="message-content">
                            <div class="message-bubble">
                                <p>Great! Let's schedule a meeting to discuss the next steps. How about Thursday afternoon?</p>
                            </div>
                            <div class="message-meta">
                                <span class="message-time">10:40 AM</span>
                            </div>
                        </div>
                    </div>

                    <!-- Sent Message -->
                    <div class="message sent">
                        <div class="message-content">
                            <div class="message-bubble">
                                <p>That sounds great! Let's plan it for next week. I'll send you a calendar invite.</p>
                            </div>
                            <div class="message-meta">
                                <span class="message-time">2m ago</span>
                                <span class="message-status delivered">✓</span>
                            </div>
                        </div>
                    </div>

                    <!-- Typing Indicator -->
                    <div class="message received typing-indicator" id="typingIndicator" style="display: none;">
                        <div class="message-avatar">
                            <img src="../images/avatar-placeholder.svg" alt="Sarah Wilson">
                        </div>
                        <div class="message-content">
                            <div class="message-bubble">
                                <div class="typing-dots">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Message Input -->
            <div class="message-input-container">
                <form class="message-input-form" id="messageForm">
                    <div class="message-attachments" id="messageAttachments">
                        <!-- File attachments will appear here -->
                    </div>
                    <div class="message-input-wrapper">
                        <button type="button" class="attachment-btn" id="attachmentBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66L9.64 16.2a2 2 0 0 1-2.83-2.83l8.49-8.49"></path>
                            </svg>
                        </button>
                        <div class="message-input-field">
                            <textarea id="messageInput" placeholder="Type a message..." rows="1"></textarea>
                        </div>
                        <button type="button" class="emoji-btn" id="emojiBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                                <line x1="15" y1="9" x2="15.01" y2="9"></line>
                            </svg>
                        </button>
                        <button type="submit" class="send-btn" id="sendBtn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="22" y1="2" x2="11" y2="13"></line>
                                <polygon points="22,2 15,22 11,13 2,9 22,2"></polygon>
                            </svg>
                        </button>
                    </div>
                </form>

                <!-- File Input (hidden) -->
                <input type="file" id="fileInput" multiple accept="image/*,video/*,audio/*,.pdf,.doc,.docx,.txt" style="display: none;">

                <!-- Emoji Picker -->
                <div class="emoji-picker" id="emojiPicker" style="display: none;">
                    <div class="emoji-grid">
                        <span class="emoji" data-emoji="😀">😀</span>
                        <span class="emoji" data-emoji="😃">😃</span>
                        <span class="emoji" data-emoji="😄">😄</span>
                        <span class="emoji" data-emoji="😁">😁</span>
                        <span class="emoji" data-emoji="😆">😆</span>
                        <span class="emoji" data-emoji="😅">😅</span>
                        <span class="emoji" data-emoji="😂">😂</span>
                        <span class="emoji" data-emoji="🤣">🤣</span>
                        <span class="emoji" data-emoji="😊">😊</span>
                        <span class="emoji" data-emoji="😇">😇</span>
                        <span class="emoji" data-emoji="🙂">🙂</span>
                        <span class="emoji" data-emoji="🙃">🙃</span>
                        <span class="emoji" data-emoji="😉">😉</span>
                        <span class="emoji" data-emoji="😌">😌</span>
                        <span class="emoji" data-emoji="😍">😍</span>
                        <span class="emoji" data-emoji="🥰">🥰</span>
                        <span class="emoji" data-emoji="😘">😘</span>
                        <span class="emoji" data-emoji="😗">😗</span>
                        <span class="emoji" data-emoji="😙">😙</span>
                        <span class="emoji" data-emoji="😚">😚</span>
                        <span class="emoji" data-emoji="😋">😋</span>
                        <span class="emoji" data-emoji="😛">😛</span>
                        <span class="emoji" data-emoji="😝">😝</span>
                        <span class="emoji" data-emoji="😜">😜</span>
                        <span class="emoji" data-emoji="🤪">🤪</span>
                        <span class="emoji" data-emoji="🤨">🤨</span>
                        <span class="emoji" data-emoji="🧐">🧐</span>
                        <span class="emoji" data-emoji="🤓">🤓</span>
                        <span class="emoji" data-emoji="😎">😎</span>
                        <span class="emoji" data-emoji="🤩">🤩</span>
                        <span class="emoji" data-emoji="🥳">🥳</span>
                        <span class="emoji" data-emoji="😏">😏</span>
                        <span class="emoji" data-emoji="👍">👍</span>
                        <span class="emoji" data-emoji="👎">👎</span>
                        <span class="emoji" data-emoji="👌">👌</span>
                        <span class="emoji" data-emoji="✌️">✌️</span>
                        <span class="emoji" data-emoji="🤞">🤞</span>
                        <span class="emoji" data-emoji="🤟">🤟</span>
                        <span class="emoji" data-emoji="🤘">🤘</span>
                        <span class="emoji" data-emoji="🤙">🤙</span>
                        <span class="emoji" data-emoji="👈">👈</span>
                        <span class="emoji" data-emoji="👉">👉</span>
                        <span class="emoji" data-emoji="👆">👆</span>
                        <span class="emoji" data-emoji="👇">👇</span>
                        <span class="emoji" data-emoji="☝️">☝️</span>
                        <span class="emoji" data-emoji="✋">✋</span>
                        <span class="emoji" data-emoji="🤚">🤚</span>
                        <span class="emoji" data-emoji="🖐️">🖐️</span>
                        <span class="emoji" data-emoji="🖖">🖖</span>
                        <span class="emoji" data-emoji="👋">👋</span>
                        <span class="emoji" data-emoji="🤝">🤝</span>
                        <span class="emoji" data-emoji="👏">👏</span>
                        <span class="emoji" data-emoji="🙌">🙌</span>
                        <span class="emoji" data-emoji="❤️">❤️</span>
                        <span class="emoji" data-emoji="💕">💕</span>
                        <span class="emoji" data-emoji="💖">💖</span>
                        <span class="emoji" data-emoji="💗">💗</span>
                        <span class="emoji" data-emoji="💙">💙</span>
                        <span class="emoji" data-emoji="💚">💚</span>
                        <span class="emoji" data-emoji="💛">💛</span>
                        <span class="emoji" data-emoji="🧡">🧡</span>
                        <span class="emoji" data-emoji="💜">💜</span>
                        <span class="emoji" data-emoji="🖤">🖤</span>
                        <span class="emoji" data-emoji="🤍">🤍</span>
                        <span class="emoji" data-emoji="🤎">🤎</span>
                        <span class="emoji" data-emoji="💔">💔</span>
                        <span class="emoji" data-emoji="❣️">❣️</span>
                        <span class="emoji" data-emoji="💯">💯</span>
                        <span class="emoji" data-emoji="🔥">🔥</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Image Modal -->
    <div class="modal" id="imageModal">
        <div class="modal-content image-modal-content">
            <button class="modal-close" id="closeImageModal">&times;</button>
            <img id="modalImage" src="" alt="Full size image">
        </div>
    </div>

    <script>
        // Navigation functionality
        document.getElementById('navToggle').addEventListener('click', function() {
            const navMenu = document.getElementById('navMenu');
            navMenu.classList.toggle('active');
        });

        // Dropdown functionality
        document.querySelectorAll('.dropdown-toggle').forEach(toggle => {
            toggle.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                const dropdown = this.parentElement;
                dropdown.classList.toggle('active');
            });
        });

        // Close dropdowns when clicking outside
        document.addEventListener('click', function() {
            document.querySelectorAll('.dropdown').forEach(dropdown => {
                dropdown.classList.remove('active');
            });
        });

        // Auto-resize textarea
        const messageInput = document.getElementById('messageInput');
        messageInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });

        // Send message
        document.getElementById('messageForm').addEventListener('submit', function(e) {
            e.preventDefault();
            sendMessage();
        });

        // Send message on Enter (but not Shift+Enter)
        messageInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        function sendMessage() {
            const messageText = messageInput.value.trim();
            if (!messageText) return;

            // Create message element
            const messageElement = createMessageElement('sent', messageText);
            
            // Add message to chat
            const messagesList = document.querySelector('.messages-list');
            messagesList.appendChild(messageElement);
            
            // Clear input
            messageInput.value = '';
            messageInput.style.height = 'auto';
            
            // Scroll to bottom
            scrollToBottom();
            
            // Show typing indicator briefly
            showTypingIndicator();
            
            // Simulate response after delay
            setTimeout(() => {
                hideTypingIndicator();
                simulateResponse();
            }, 2000 + Math.random() * 2000);
        }

        function createMessageElement(type, text, time = 'Just now') {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            
            const messageBubble = document.createElement('div');
            messageBubble.className = 'message-bubble';
            messageBubble.innerHTML = `<p>${text}</p>`;
            
            const messageMeta = document.createElement('div');
            messageMeta.className = 'message-meta';
            messageMeta.innerHTML = `
                <span class="message-time">${time}</span>
                ${type === 'sent' ? '<span class="message-status delivered">✓</span>' : ''}
            `;
            
            messageContent.appendChild(messageBubble);
            messageContent.appendChild(messageMeta);
            
            if (type === 'received') {
                const messageAvatar = document.createElement('div');
                messageAvatar.className = 'message-avatar';
                messageAvatar.innerHTML = '<img src="../images/avatar-placeholder.svg" alt="Sarah Wilson">';
                messageDiv.appendChild(messageAvatar);
            }
            
            messageDiv.appendChild(messageContent);
            return messageDiv;
        }

        function showTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            typingIndicator.style.display = 'flex';
            scrollToBottom();
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            typingIndicator.style.display = 'none';
        }

        function simulateResponse() {
            const responses = [
                "Thanks for sharing that!",
                "That sounds great!",
                "I agree completely.",
                "Interesting perspective!",
                "Let me think about that.",
                "Absolutely!",
                "That's a good point.",
                "I'll get back to you on that."
            ];
            
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            const responseElement = createMessageElement('received', randomResponse);
            
            const messagesList = document.querySelector('.messages-list');
            messagesList.appendChild(responseElement);
            
            scrollToBottom();
        }

        function scrollToBottom() {
            const messagesArea = document.getElementById('messagesArea');
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }

        // File attachment
        document.getElementById('attachmentBtn').addEventListener('click', function() {
            document.getElementById('fileInput').click();
        });

        document.getElementById('fileInput').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            displayAttachments(files);
        });

        function displayAttachments(files) {
            const attachmentsContainer = document.getElementById('messageAttachments');
            attachmentsContainer.innerHTML = '';
            
            files.forEach((file, index) => {
                const attachmentDiv = document.createElement('div');
                attachmentDiv.className = 'attachment-preview';
                
                if (file.type.startsWith('image/')) {
                    const img = document.createElement('img');
                    img.src = URL.createObjectURL(file);
                    img.alt = file.name;
                    attachmentDiv.appendChild(img);
                } else {
                    attachmentDiv.innerHTML = `
                        <div class="file-icon">📄</div>
                        <span class="file-name">${file.name}</span>
                    `;
                }
                
                const removeBtn = document.createElement('button');
                removeBtn.className = 'remove-attachment';
                removeBtn.innerHTML = '×';
                removeBtn.onclick = () => attachmentDiv.remove();
                
                attachmentDiv.appendChild(removeBtn);
                attachmentsContainer.appendChild(attachmentDiv);
            });
            
            attachmentsContainer.style.display = files.length > 0 ? 'flex' : 'none';
        }

        // Emoji picker
        document.getElementById('emojiBtn').addEventListener('click', function() {
            const emojiPicker = document.getElementById('emojiPicker');
            emojiPicker.style.display = emojiPicker.style.display === 'none' ? 'block' : 'none';
        });

        document.querySelectorAll('.emoji').forEach(emoji => {
            emoji.addEventListener('click', function() {
                const emojiChar = this.dataset.emoji;
                messageInput.value += emojiChar;
                document.getElementById('emojiPicker').style.display = 'none';
                messageInput.focus();
            });
        });

        // Hide emoji picker when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.emoji-btn') && !e.target.closest('.emoji-picker')) {
                document.getElementById('emojiPicker').style.display = 'none';
            }
        });

        // Image modal
        function openImageModal(src) {
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            modalImage.src = src;
            modal.classList.add('active');
        }

        document.getElementById('closeImageModal').addEventListener('click', function() {
            document.getElementById('imageModal').classList.remove('active');
        });

        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.remove('active');
            }
        });

        // Action buttons
        document.getElementById('videoCallBtn').addEventListener('click', function() {
            alert('Video call feature would be implemented here');
        });

        document.getElementById('audioCallBtn').addEventListener('click', function() {
            alert('Audio call feature would be implemented here');
        });

        document.getElementById('viewProfileBtn').addEventListener('click', function() {
            window.location.href = 'user-profile.html?user=sarah-wilson';
        });

        document.getElementById('muteConversationBtn').addEventListener('click', function() {
            alert('Conversation muted');
        });

        document.getElementById('archiveConversationBtn').addEventListener('click', function() {
            if (confirm('Are you sure you want to archive this conversation?')) {
                alert('Conversation archived');
            }
        });

        document.getElementById('blockUserBtn').addEventListener('click', function() {
            if (confirm('Are you sure you want to block this user?')) {
                alert('User blocked');
            }
        });

        document.getElementById('deleteConversationBtn').addEventListener('click', function() {
            if (confirm('Are you sure you want to delete this conversation? This action cannot be undone.')) {
                alert('Conversation deleted');
                window.location.href = 'messages.html';
            }
        });

        // Scroll to bottom on page load
        scrollToBottom();

        // Mark messages as read after delay
        setTimeout(() => {
            document.querySelectorAll('.message-status.delivered').forEach(status => {
                status.textContent = '✓✓';
                status.className = 'message-status read';
            });
        }, 3000);
    </script>
</body>
</html>
